<!DOCTYPE html>
<html lang="pt-BR">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2 - Marcelo Cavalcante Rocha</title><meta name="Description" content="Todos sabem que o Terraform é uma solucão fantástica para criar infraestrutura através de código, porém nem todos utilizam as diversas possibilidades do mesmo, como por exemplos módulos. Com módulos podemos fazer a reutilização de código para nossa infraestrutura."><meta property="og:url" content="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/">
  <meta property="og:site_name" content="Marcelo Cavalcante Rocha">
  <meta property="og:title" content="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2">
  <meta property="og:description" content="Todos sabem que o Terraform é uma solucão fantástica para criar infraestrutura através de código, porém nem todos utilizam as diversas possibilidades do mesmo, como por exemplos módulos. Com módulos podemos fazer a reutilização de código para nossa infraestrutura.">
  <meta property="og:locale" content="pt_BR">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-05-20T14:09:21-04:00">
    <meta property="article:modified_time" content="2019-05-20T14:09:21-04:00">
    <meta property="article:tag" content="Devops">
    <meta property="article:tag" content="Terraform">
    <meta property="article:tag" content="Cloud">
    <meta property="article:tag" content="AWS">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2">
  <meta name="twitter:description" content="Todos sabem que o Terraform é uma solucão fantástica para criar infraestrutura através de código, porém nem todos utilizam as diversas possibilidades do mesmo, como por exemplos módulos. Com módulos podemos fazer a reutilização de código para nossa infraestrutura.">
<meta name="application-name" content="Marcelo Cavalcante">
<meta name="apple-mobile-web-app-title" content="Marcelo Cavalcante">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" /><link rel="prev" href="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como/" /><link rel="next" href="//blog.marcelocavalcante.net:1313/posts/criando-uma-pipeline-para-terraform/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2",
        "inLanguage": "pt-BR",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "\/\/blog.marcelocavalcante.net:1313\/posts\/terraform-modules-porque-e-como-copy\/"
        },"genre": "posts","keywords": "Devops, Terraform, Cloud, AWS","wordcount":  8053 ,
        "url": "\/\/blog.marcelocavalcante.net:1313\/posts\/terraform-modules-porque-e-como-copy\/","datePublished": "2019-05-20T14:09:21-04:00","dateModified": "2019-05-20T14:09:21-04:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Marcelo Cavalcante"
            },"description": "Todos sabem que o Terraform é uma solucão fantástica para criar infraestrutura através de código, porém nem todos utilizam as diversas possibilidades do mesmo, como por exemplos módulos. Com módulos podemos fazer a reutilização de código para nossa infraestrutura."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Marcelo Cavalcante Rocha"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://marcelocavalcante.net/ftp/logonew.png"
        data-srcset="https://marcelocavalcante.net/ftp/logonew.png, https://marcelocavalcante.net/ftp/logonew.png 1.5x, https://marcelocavalcante.net/ftp/logonew.png 2x"
        data-sizes="auto"
        alt="https://marcelocavalcante.net/ftp/logonew.png"
        title="https://marcelocavalcante.net/ftp/logonew.png" />A sabedoria se constrói no silêncio paciente de todos os dias.</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categorias </a><a class="menu-item" href="/sobre/"> Quem Sou </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Pesquisar títulos ou conteúdos ..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Pesquisa">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Limpar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Trocar tema">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Marcelo Cavalcante Rocha"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://marcelocavalcante.net/ftp/logonew.png"
        data-srcset="https://marcelocavalcante.net/ftp/logonew.png, https://marcelocavalcante.net/ftp/logonew.png 1.5x, https://marcelocavalcante.net/ftp/logonew.png 2x"
        data-sizes="auto"
        alt="https://marcelocavalcante.net/ftp/logonew.png"
        title="https://marcelocavalcante.net/ftp/logonew.png" />A sabedoria se constrói no silêncio paciente de todos os dias.</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Pesquisar títulos ou conteúdos ..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Pesquisa">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Limpar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancelar
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categorias</a><a class="menu-item" href="/sobre/" title="">Quem Sou</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Trocar tema">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Conteúdos</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.marcelocavalcante.net" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Marcelo Cavalcante</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2019-05-20">2019-05-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;8053 palavras&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;38 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Conteúdos</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#user-data">User Data</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><strong>OBS:</strong> Este post é a continuação do post anterior e utilizará a mesma base de código, portanto se você não leu o anterior, comece por lá clicando aqui: <!-- raw HTML omitted -->Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 1<!-- raw HTML omitted --></p>
<p><strong>C</strong>ontinuando de onde paramos&hellip;</p>
<h2 id="user-data">User Data</h2>
<p><strong>O</strong> AWS possui um recurso chamado <em>User Data</em>, o qual nos permite passar um script (bash) que deverá ser executado no momento de criação de uma instância. Utilizaremos este recurso do AWS também através de nosso código Terraform para:</p>
<ul>
<li>Atualizar nossa base de repositórios do APT;</li>
<li>Instalar e iniciar os serviços necessários;</li>
<li>Liberar os serviços necessários no firewall do Ubuntu.</li>
</ul>
<p><strong>C</strong>aso suas instâncias ainda estejam rodando, você perceberá que o Terraform tentará destruir a instância e criá-la novamente após fazermos esta alteração. Isto se dá porque uma das alterações que faremos de fato exigirá que uma nova instância seja criada, pois incluiremos um script que deve rodar durante a criação da instância e, obviamente, a única forma de este script ser executado é justamente criando a instância novamente. Mas isso não é problema, certo? Somos engenheiros devops e em um mundo devops o objetivo é ter uma infraestrutura automatizada e extremamente descartável, certo? É por isso que codificamos tudo.</p>
<p><strong>C</strong>omeçaremos com nosso servidor <em>webserver</em>.</p>
<p><strong>V</strong>amos incluir uma nova tag <em>(Projeto)</em> bem como um bash script que será utilizado como <em>user_data</em>. Este bash script atualizará nossa base de repositórios e instalará o servidor web apache2, bem como habilitará o webserver no firewall padrão do Ubuntu.</p>
<p><strong>E</strong>ste recurso <em>user_data</em> não é exatamente do Terraform, mas sim um mecanismo que o AWS nos provê para que possamos ter um script executado no momento de criação de uma instância ou VM.</p>
<p><strong>N</strong>osso arquivo <em>variables.tf</em> do projeto <em>webserver</em> agora deverá estar assim:</p>
<div class="code-block open" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;region&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Região no AWS onde nossos recursos estarão.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;us-east-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;ami&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Id da imagem EC2 que desejamos utilizar para nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instance_type&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tipo de instância a ser utilizado&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas à nossa instância.&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span>     <span class="o">=</span> <span class="s2">&#34;Ubuntu-webserver&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Ambiente&#34;</span> <span class="o">=</span> <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Projeto&#34;</span>  <span class="o">=</span> <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;user_data&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Script a ser executado durante a criação da instância.&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="n">EOF</span>
</span></span><span class="line hl"><span class="cl">              <span class="c1">#!/bin/bash</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">apache2</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">apache2</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">apache2</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="s1">&#39;Apache&#39;</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">EOF</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>A</strong>gora que temos nossa variável <em>user_data</em> criada, devemos inserir isto em nosso arquivo <em>main.tf</em> para que nossa instância possa utilizar este script de inicialização. Nosso <em>main.tf</em> do projeto <em>webserver</em> agora ficará assim:</p>
<div class="code-block open" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">provider</span> <span class="s2">&#34;aws&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">region</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.region}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_instance&#34;</span> <span class="s2">&#34;server1&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ami</span>           <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.ami}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.instance_type}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">user_data</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.user_data}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>C</strong>om estas alterações já conseguiríamos criar um servidor web com Apache2, no entanto por padrão o AWS mantém as portas de novas instâncias fechadas para o mundo externo, portanto precisamos também criar alguns <em>resources</em> para que nossa instância seja de fato utilizável:</p>
<ul>
<li>VPC: Virtual Private Cloud é o recurso utilizado pelo AWS para definições de redes dentro de sua conta AWS;</li>
<li>Subnet: Definiremos uma subnet ou sub-rede para nossa infraestrutura;</li>
<li>Internet Gateway: Um gateway do aws que permitirá que nossa instância s ecomunique com a internet;</li>
<li>Route Table: Um atabela de roteamento que permitirá que nossa vpc encaminhe pacotes devidamente;</li>
<li>Security Groups: Security Groups ou Grupos de Segurança é como o AWS chama suas definições e regras de firewall;</li>
<li>Adicionar um ip público ao servidor.</li>
</ul>
<p><strong>V</strong>amos começar criando todas as novas variáveis que precisaremos. Nosso arquivo <em>variables.tf</em> do projeto <em>webserver</em> receberá várias alterações. As variáveis que devemos criar são:</p>
<ul>
<li>Uma porta de origem para a regra de entrada ou <em>ingress</em>: <em>i_from_port</em>;</li>
<li>Uma porta de destino para a regra de entrada ou <em>ingress</em>: <em>i_to_port</em>;</li>
<li>Um IP ou range de ips para a regra de entrada ou <em>ingress</em>: <em>i_ip_range</em>;</li>
<li>Uma porta de origem para a regra de saída ou <em>egress</em>: <em>e_from_port</em>;</li>
<li>Uma porta de destino para a regra de saída ou <em>egress</em>: <em>e_to_port</em>;</li>
<li>Um IP ou range de ips para a regra de saída ou <em>egress</em>: <em>e_ip_range</em>;</li>
<li>Range de ips a ser utilizado na VPC ou <em>Virtual Private Cloud</em>: <em>vpc_ip_range</em>;</li>
<li>Tags para o gateway de internet: <em>dev_gw_tags</em>;</li>
<li>IP ou range de ips a serem aplicados na tabela de routeamento ou <em>route tables</em>: <em>rev_route_ips</em>;</li>
<li>Tags para nossa tabela de roteamento: <em>dev_route_tags</em></li>
</ul>
<p><strong>N</strong>osso arquivo <em>variables.tf</em> do projeto <em>webserver</em> deverá ficar assim:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;region&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Região no AWS onde nossos recursos estarão.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;us-east-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;ami&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Id da imagem EC2 que desejamos utilizar para nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instance_type&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tipo de instância a ser utilizado&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas à nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Name&#34;</span>     <span class="o">=</span> <span class="s2">&#34;Ubuntu-webserver&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Ambiente&#34;</span> <span class="o">=</span> <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Projeto&#34;</span>  <span class="o">=</span> <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;user_data&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Script a ser executado durante a criação da instância.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="n">EOF</span>
</span></span><span class="line"><span class="cl">              <span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">apache2</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">apache2</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">apache2</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="s1">&#39;Apache&#39;</span>
</span></span><span class="line"><span class="cl">              <span class="n">EOF</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Uma porta de origem para a regra de entrada ou ingress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="mi">80</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Uma porta de destino para a regra de entrada ou ingress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="mi">80</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;IP ou range de ips para a regra de entrada ou ingress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Uma porta de origem para a regra de saída ou egress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Uma porta de destino para a regra de saída ou egress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;IP ou range de ips para a regra de saída ou egress.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs para a VPC&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;10.0.0.0/16&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;dev_gw_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas ao gateway de internet&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-env-gw&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;dev_route_ips&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs a serem aplicados na route table&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;dev_route_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas na route table&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-env-route-table&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>C</strong>om nossas variáveis criadas, vamos inserir estes <em>resources</em> em nosso arquivo <em>main.tf</em> do projeto <em>webserver</em>, o qual agora deverá ficar assim:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">provider</span> <span class="s2">&#34;aws&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">region</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.region}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_vpc&#34;</span> <span class="s2">&#34;dev-env&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">cidr_block</span>           <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.vpc_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">enable_dns_hostnames</span> <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">enable_dns_support</span>   <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_subnet&#34;</span> <span class="s2">&#34;dev-subnet&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">cidr_block</span>        <span class="o">=</span> <span class="s2">&#34;${cidrsubnet(aws_vpc.dev-env.cidr_block, 3, 1)}&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">vpc_id</span>            <span class="o">=</span> <span class="s2">&#34;${aws_vpc.dev-env.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">availability_zone</span> <span class="o">=</span> <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_security_group&#34;</span> <span class="s2">&#34;webserver&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;firewall_webserver&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_vpc.dev-env.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">ingress</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">protocol</span>    <span class="o">=</span> <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">cidr_blocks</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">egress</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">protocol</span>    <span class="o">=</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">cidr_blocks</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_instance&#34;</span> <span class="s2">&#34;server1&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ami</span>           <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.ami}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.instance_type}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">user_data</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.user_data}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">security_groups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;$</span><span class="si">{aws_security_group.webserver.id}</span><span class="s2">&#34;</span><span class="p">]</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">subnet_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_subnet.dev-subnet.id}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_eip&#34;</span> <span class="s2">&#34;webserver-dev-ip&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">instance</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_instance.server1.id}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">vpc</span>      <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_internet_gateway&#34;</span> <span class="s2">&#34;dev-gw&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_vpc.dev-env.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.dev_gw_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_route_table&#34;</span> <span class="s2">&#34;route-table-dev-env&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_vpc.dev-env.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">route</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">cidr_block</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.dev_route_ips}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">gateway_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_internet_gateway.dev-gw.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.dev_route_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_route_table_association&#34;</span> <span class="s2">&#34;subnet-association&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">subnet_id</span>      <span class="o">=</span> <span class="s2">&#34;${aws_subnet.dev-subnet.id}&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">route_table_id</span> <span class="o">=</span> <span class="s2">&#34;${aws_route_table.route-table-dev-env.id}&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>F</strong>izemos muitas alterações, mas agora temos uma solução completa para que nosso webserver seja funcional. Criamos uma vpc, subnet, regras de firewall, ip estático público, tabela de roteamento, gateway de internet.. ufa.. Missão cumprida.</p>
<p><strong>C</strong>om estas mudanças indicamos que estaremos aceitando conexões vindas pela porta 80, para a porta também 80. Estamos informando também que conexões de qualquer endereço IP serão aceitas, afinal queremos que nosso webserver seja acessível ao mundo inteiro via internet.</p>
<p><strong>T</strong>ambém abrimos a porta 80 para conexões saindo, pois nosso webserver precisa ser capaz de responder às requisições que receber, certo?!</p>
<p><strong>I</strong>sto já é o suficiente para criarmos novamente nosso servidor web, desta vez funcional. Execute <em>terraform plan</em>.</p>
<p><strong>S</strong>e suas instâncias ainda estavam rodando, o Terraform irá apenas destruir a instância de nosso <em>webserver</em> para criar uma nova, aplicando todas as nossas mudanças. Caso você tenha destruído a mesma com <em>terraform destroy</em> antes, uma nova será criada da mesma forma. Lembre-se de executar o comando <em>terraform plan</em> a partir do diretório onde se encontra nosso projeto <em>webserver</em>:</p>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform plan
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Refreshing Terraform state in-memory prior to plan...
</span></span><span class="line"><span class="cl">The refreshed state will be used to calculate this plan, but will not be
</span></span><span class="line"><span class="cl">persisted to <span class="nb">local</span> or remote state storage.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">An execution plan has been generated and is shown below.
</span></span><span class="line"><span class="cl">Resource actions are indicated with the following symbols:
</span></span><span class="line"><span class="cl">  + create
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Terraform will perform the following actions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_eip.webserver-dev-ip
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      allocation_id:                               &lt;computed&gt;
</span></span><span class="line"><span class="cl">      association_id:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      domain:                                      &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance:                                    <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_instance</span><span class="p">.server1.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      network_interface:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ipv4_pool:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc:                                         <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_instance.server1
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ami:                                         <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">      arn:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      associate_public_ip_address:                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      availability_zone:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_core_count:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_threads_per_core:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ebs_block_device.#:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ephemeral_block_device.#:                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      get_password_data:                           <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      host_id:                                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_state:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_type:                               <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_address_count:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_addresses.#:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      key_name:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      password_data:                               &lt;computed&gt;
</span></span><span class="line"><span class="cl">      placement_group:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      primary_network_interface_id:                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      root_block_device.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      security_groups.#:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      source_dest_check:                           <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                   <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.dev-subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                      <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Ambiente:                               <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                   <span class="s2">&#34;Ubuntu-webserver&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Projeto:                                <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">      tenancy:                                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      user_data:                                   <span class="s2">&#34;667f17a65f03728b9c8f8c29166f86915a180f0b&#34;</span>
</span></span><span class="line"><span class="cl">      volume_tags.%:                               &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc_security_group_ids.#:                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_internet_gateway.dev-gw
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                      <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                   <span class="s2">&#34;dev-env-gw&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                      <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.dev-env.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_route_table.route-table-dev-env
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      propagating_vgws.#:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route.#:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.cidr_block:                <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.gateway_id:                <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_internet_gateway</span><span class="p">.dev-gw.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.instance_id:               <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.nat_gateway_id:            <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.network_interface_id:      <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.transit_gateway_id:        <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~3748360916.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                      <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                   <span class="s2">&#34;dev-env-route-table&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                      <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.dev-env.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_route_table_association.subnet-association
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route_table_id:                              <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_route_table</span><span class="p">.route-table-dev-env.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                   <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.dev-subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_security_group.webserver
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      description:                                 <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.#:                                    <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.#:              <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.0:              <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.description:                <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.482069346.from_port:                  <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.ipv6_cidr_blocks.#:         <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.prefix_list_ids.#:          <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.protocol:                   <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.security_groups.#:          <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.self:                       <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.to_port:                    <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.#:                                   <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.cidr_blocks.#:            <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.cidr_blocks.0:            <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.description:              <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.from_port:                <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.ipv6_cidr_blocks.#:       <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.prefix_list_ids.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.protocol:                 <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.security_groups.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.self:                     <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.to_port:                  <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">      name:                                        <span class="s2">&#34;firewall_webserver&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      revoke_rules_on_delete:                      <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                      <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.dev-env.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_subnet.dev-subnet
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_ipv6_address_on_creation:             <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone:                           <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cidr_block:                                  <span class="s2">&#34;10.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block_association_id:              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      map_public_ip_on_launch:                     <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc_id:                                      <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.dev-env.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + aws_vpc.dev-env
</span></span><span class="line"><span class="cl">      id:                                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_generated_ipv6_cidr_block:            <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      cidr_block:                                  <span class="s2">&#34;10.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">      default_network_acl_id:                      &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_route_table_id:                      &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_security_group_id:                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      dhcp_options_id:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink_dns_support:              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_dns_hostnames:                        <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      enable_dns_support:                          <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      instance_tenancy:                            <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_association_id:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      main_route_table_id:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Plan: <span class="m">8</span> to add, <span class="m">0</span> to change, <span class="m">0</span> to destroy.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: You didn<span class="s1">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span></span></span><span class="line"><span class="cl"><span class="s1">can&#39;</span>t guarantee that exactly these actions will be performed <span class="k">if</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;terraform apply&#34;</span> is subsequently run.</span></span></code></pre></div></div>
<p><strong>T</strong>udo parece correto. Podemos ver a instância que será criada novamente, bem como nossas regras de firewall no security groups, a vcp, subnet, ip estático, gateway de internet e tabelas de roteamento. Ao todo podemos ver que o terraform criará 8 <em>resources</em>. Agora vamos executar <em>terraform apply</em>:</p>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">(</span>...<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">aws_vpc.dev-env: Creating...
</span></span><span class="line"><span class="cl">  arn:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_generated_ipv6_cidr_block: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;10.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">  default_network_acl_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_route_table_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_security_group_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  dhcp_options_id:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink_dns_support:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_hostnames:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_support:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  instance_tenancy:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_association_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  main_route_table_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">aws_vpc.dev-env: Creation <span class="nb">complete</span> after 3s <span class="o">(</span>ID: vpc-0f91d1c9fb8b4e7de<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_subnet.dev-subnet: Creating...
</span></span><span class="line"><span class="cl">  arn:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_ipv6_address_on_creation: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;10.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block_association_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  map_public_ip_on_launch:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0f91d1c9fb8b4e7de&#34;</span>
</span></span><span class="line"><span class="cl">aws_internet_gateway.dev-gw: Creating...
</span></span><span class="line"><span class="cl">  owner_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:    <span class="s2">&#34;0&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-env-gw&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0f91d1c9fb8b4e7de&#34;</span>
</span></span><span class="line"><span class="cl">aws_security_group.webserver: Creating...
</span></span><span class="line"><span class="cl">  arn:                                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  description:                           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.#:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.#:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.0:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.description:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.482069346.from_port:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.ipv6_cidr_blocks.#:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.prefix_list_ids.#:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.protocol:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.security_groups.#:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.self:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.to_port:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.#:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.cidr_blocks.#:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.cidr_blocks.0:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.description:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.from_port:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.ipv6_cidr_blocks.#: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.prefix_list_ids.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.protocol:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.security_groups.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.self:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.to_port:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">  name:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;firewall_webserver&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  revoke_rules_on_delete:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0f91d1c9fb8b4e7de&#34;</span>
</span></span><span class="line"><span class="cl">aws_subnet.dev-subnet: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: subnet-0f39213695d2a53f9<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_internet_gateway.dev-gw: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: igw-065672778ce66cde4<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_route_table.route-table-dev-env: Creating...
</span></span><span class="line"><span class="cl">  owner_id:                                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  propagating_vgws.#:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  route.#:                                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.cidr_block:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.gateway_id:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;igw-065672778ce66cde4&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.instance_id:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.nat_gateway_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.network_interface_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.transit_gateway_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.3509993845.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-env-route-table&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0f91d1c9fb8b4e7de&#34;</span>
</span></span><span class="line"><span class="cl">aws_security_group.webserver: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: sg-043a9f8883a916b59<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Creating...
</span></span><span class="line"><span class="cl">  ami:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">  arn:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  associate_public_ip_address:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_core_count:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_threads_per_core:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ebs_block_device.#:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ephemeral_block_device.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  get_password_data:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  host_id:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_state:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_type:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_address_count:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_addresses.#:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  key_name:                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface_id:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  password_data:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  placement_group:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  primary_network_interface_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  root_block_device.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.#:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.4047892134:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;sg-043a9f8883a916b59&#34;</span>
</span></span><span class="line"><span class="cl">  source_dest_check:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-0f39213695d2a53f9&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Ambiente:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Ubuntu-webserver&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Projeto:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">  tenancy:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  user_data:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;667f17a65f03728b9c8f8c29166f86915a180f0b&#34;</span>
</span></span><span class="line"><span class="cl">  volume_tags.%:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_security_group_ids.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">aws_route_table.route-table-dev-env: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: rtb-0dc9e16bc23a8f496<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_route_table_association.subnet-association: Creating...
</span></span><span class="line"><span class="cl">  route_table_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;rtb-0dc9e16bc23a8f496&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-0f39213695d2a53f9&#34;</span>
</span></span><span class="line"><span class="cl">aws_route_table_association.subnet-association: Creation <span class="nb">complete</span> after 0s <span class="o">(</span>ID: rtbassoc-006d825f24a095591<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Still creating... <span class="o">(</span>10s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Still creating... <span class="o">(</span>20s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Still creating... <span class="o">(</span>30s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Creation <span class="nb">complete</span> after 34s <span class="o">(</span>ID: i-03897e1ae2477b4fd<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_eip.webserver-dev-ip: Creating...
</span></span><span class="line"><span class="cl">  allocation_id:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  association_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  domain:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;i-03897e1ae2477b4fd&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ipv4_pool:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">aws_eip.webserver-dev-ip: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: eipalloc-0aa1c542ad7f22d19<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apply complete! Resources: <span class="m">8</span> added, <span class="m">0</span> changed, <span class="m">0</span> destroyed.</span></span></code></pre></div></div>
<p><strong>A</strong>parentemente tudo está correto.</p>
<p><strong>P</strong>rimeiramente, verificarei se meu <em>Security Group</em> foi devidamente criado para permitir as conexões na porta 80. Para isto, clique em Grupos de Segurança <em>(Security Groups)</em> no menu lateral esquerdo da Dashboard EC2 no AWS:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/terraform_aws12.jpg"
        data-srcset="/img/terraform_aws12.jpg, /img/terraform_aws12.jpg 1.5x, /img/terraform_aws12.jpg 2x"
        data-sizes="auto"
        alt="/img/terraform_aws12.jpg"
        title="AWS IAM" /></p>
<p><strong>N</strong>osso <em>Security Group</em> foi criado corretamente conforme previsto. Agora podemos verificar se nossa instância foi criada, voltando para o menu de Instâncias. Ao identificar sua nova instância, selecione a caixa no canto esquerdo da mesma para que possamos ver as informações detalhadas desta instância, visto que precisaremos do DNS público para testarmos nosso webserver:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/terraform_aws13.jpg"
        data-srcset="/img/terraform_aws13.jpg, /img/terraform_aws13.jpg 1.5x, /img/terraform_aws13.jpg 2x"
        data-sizes="auto"
        alt="/img/terraform_aws13.jpg"
        title="AWS IAM" /></p>
<p><strong>C</strong>opie este endereço de DNS Público e teste seu novo servidor web. Você pode fazê-lo através de um terminal ou console executando o comando <em>curl &lt;seu endereço DNS público&gt;</em>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl ec2-3-214-101-37.compute-1.amazonaws.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html PUBLIC <span class="s2">&#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34;</span> <span class="s2">&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;</span>&gt;
</span></span><span class="line"><span class="cl">&lt;html <span class="nv">xmlns</span><span class="o">=</span><span class="s2">&#34;http://www.w3.org/1999/xhtml&#34;</span>&gt;
</span></span><span class="line"><span class="cl">  &lt;!--
</span></span><span class="line"><span class="cl">    Modified from the Debian original <span class="k">for</span> Ubuntu
</span></span><span class="line"><span class="cl">    Last updated: 2016-11-16
</span></span><span class="line"><span class="cl">    See: https://launchpad.net/bugs/1288690
</span></span><span class="line"><span class="cl">  --&gt;
</span></span><span class="line"><span class="cl">  &lt;head&gt;
</span></span><span class="line"><span class="cl">    &lt;meta http-equiv<span class="o">=</span><span class="s2">&#34;Content-Type&#34;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&#34;text/html; charset=UTF-8&#34;</span> /&gt;
</span></span><span class="line"><span class="cl">    &lt;title&gt;Apache2 Ubuntu Default Page: It works&lt;/title&gt;
</span></span><span class="line"><span class="cl">    &lt;style <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span> <span class="nv">media</span><span class="o">=</span><span class="s2">&#34;screen&#34;</span>&gt;
</span></span><span class="line"><span class="cl">  * <span class="o">{</span>
</span></span><span class="line"><span class="cl">    margin: 0px 0px 0px 0px<span class="p">;</span>
</span></span><span class="line"><span class="cl">    padding: 0px 0px 0px 0px<span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></div>
<p><strong>O</strong>u através de um navegador de internet qualquer, no qual você será capaz de ver a página inicial padrão do Apache:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/terraform_aws14.jpg"
        data-srcset="/img/terraform_aws14.jpg, /img/terraform_aws14.jpg 1.5x, /img/terraform_aws14.jpg 2x"
        data-sizes="auto"
        alt="/img/terraform_aws14.jpg"
        title="AWS IAM" /></p>
<p><strong>M</strong>issão realmente cumprida? Claro que não. Afinal, ainda temos nosso projeto db, certo?! Temos que criar uma instância para nosso banco de dados.</p>
<p><strong>N</strong>ão sei quanto a você, mas só de lembrar já dá vontade de desistir. Se fizemos todas essas mudanças para o webserver, agora precisaríamos fazer tudo similar para o <em>db</em>. <strong>ERRADO!</strong></p>
<p><strong>A</strong>gora que sofremos e fizemos de forma menos otimizada, vamos fazer com que possamos reaproveitar código para que não precisemos replicar tudo para o projeto <em>db</em> ou para diversos outros que possam surgir.</p>
<p><strong>A</strong> ideia de utilizar-se módulos no Terraform é justamente a possibilidade de termos blocos de código de uso comum que possam ser reaproveitados de forma simplificada, embora ainda mantendo a flexibilidade de alterar atributos neste módulo.</p>
<p><strong>S</strong>e por exemplo você costuma criar muitos clusters Kubernetes, ao invés de reescrever todo o código o tempo todo, o ideal seria ter um módulo Kubernetes com todos os parâmetros necessários para criar um cluster. Este módulo poderia ser importado por diversos projetos, alterando apenas as variáveis necessárias para tal projeto em específico.</p>
<p><strong>P</strong>or hora, vamos destruir novamente nossa infraestrutura para não mantermos recursos no ar desnecessariamente. Execute <em>terraform destroy</em>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform destroy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">(</span>...<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_eip.webserver-dev-ip: Destroying... <span class="o">(</span>ID: eipalloc-0aa1c542ad7f22d19<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_route_table_association.subnet-association: Destroying... <span class="o">(</span>ID: rtbassoc-006d825f24a095591<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_route_table_association.subnet-association: Destruction <span class="nb">complete</span> after 1s
</span></span><span class="line"><span class="cl">aws_route_table.route-table-dev-env: Destroying... <span class="o">(</span>ID: rtb-0dc9e16bc23a8f496<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_route_table.route-table-dev-env: Destruction <span class="nb">complete</span> after 1s
</span></span><span class="line"><span class="cl">aws_internet_gateway.dev-gw: Destroying... <span class="o">(</span>ID: igw-065672778ce66cde4<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_eip.webserver-dev-ip: Destruction <span class="nb">complete</span> after 2s
</span></span><span class="line"><span class="cl">aws_instance.server1: Destroying... <span class="o">(</span>ID: i-03897e1ae2477b4fd<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_internet_gateway.dev-gw: Still destroying... <span class="o">(</span>ID: igw-065672778ce66cde4, 10s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Still destroying... <span class="o">(</span>ID: i-03897e1ae2477b4fd, 10s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_internet_gateway.dev-gw: Destruction <span class="nb">complete</span> after 10s
</span></span><span class="line"><span class="cl">aws_instance.server1: Still destroying... <span class="o">(</span>ID: i-03897e1ae2477b4fd, 20s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Still destroying... <span class="o">(</span>ID: i-03897e1ae2477b4fd, 30s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_instance.server1: Destruction <span class="nb">complete</span> after 30s
</span></span><span class="line"><span class="cl">aws_security_group.webserver: Destroying... <span class="o">(</span>ID: sg-043a9f8883a916b59<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_subnet.dev-subnet: Destroying... <span class="o">(</span>ID: subnet-0f39213695d2a53f9<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_security_group.webserver: Destruction <span class="nb">complete</span> after 1s
</span></span><span class="line"><span class="cl">aws_subnet.dev-subnet: Destruction <span class="nb">complete</span> after 1s
</span></span><span class="line"><span class="cl">aws_vpc.dev-env: Destroying... <span class="o">(</span>ID: vpc-0f91d1c9fb8b4e7de<span class="o">)</span>
</span></span><span class="line"><span class="cl">aws_vpc.dev-env: Destruction <span class="nb">complete</span> after 0s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Destroy complete! Resources: <span class="m">8</span> destroyed.</span></span></code></pre></div></div>
<p><strong>V</strong>amos agora criar nosso módulo <em>setup_vm</em>.</p>
<p><strong>O</strong> ideal é criarmos sempre módulos simples com funções bem específicas, portanto aqui poderíamos ter diversos módulos, como por exemplo: <em>instância</em>, <em>vpc</em>, <em>security_group</em>, <em>subnet</em>, etc&hellip; No entanto, para simplificar nosso exemplo, criaremos um módulo apenas que criará a instância (vm) bem como todos os recursos de rede que forem necessários para ter nosso webserver funcional.</p>
<p><strong>S</strong>e lembrarmos bem, nossa árvore de diretórios é a seguinte:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">terraform
</span></span><span class="line"><span class="cl">└── db
</span></span><span class="line"><span class="cl">    ├── main.tf
</span></span><span class="line"><span class="cl">    ├── variables.tf
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate.backup
</span></span><span class="line"><span class="cl">└── webserver
</span></span><span class="line"><span class="cl">    ├── main.tf
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate.backup
</span></span><span class="line"><span class="cl">    └── variables.tf</span></span></code></pre></div></div>
<p><strong>N</strong>ovamente, ignore caso você não possua os arquivos <em>terraform.tfstate</em> e <em>terraform.tfstate.backup</em>, eles não atrapalham em nada, visto que não os tendo você apenas precisaria executar novamente <em>terraform init .</em> dentro de cada projeto antes do <em>plan</em> e do <em>apply</em>.</p>
<p><strong>C</strong>omecemos criando um diretório chamado <em>modules</em> para armazenarmos nossos módulos e, dentro deste novo diretório, criaremos um diretório chamado <em>vm_setup</em>, para nosso módulo que criará nossa instância bem como a configuração de rede para a mesma. Após criado o diretório, criaremos dois arquivos vazios, <em>main.tf</em> e <em>variables.tf</em>, dentro do diretório <em>vm_setup</em>. Nossa árvore de diretórios deverá estar assim:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">terraform
</span></span><span class="line"><span class="cl">├── db
</span></span><span class="line"><span class="cl">│   ├── main.tf
</span></span><span class="line"><span class="cl">│   ├── terraform.tfstate
</span></span><span class="line"><span class="cl">│   ├── terraform.tfstate.backup
</span></span><span class="line"><span class="cl">│   └── variables.tf
</span></span><span class="line"><span class="cl">├── modules
</span></span><span class="line"><span class="cl">│   └── vm_setup
</span></span><span class="line"><span class="cl">│       ├── main.tf
</span></span><span class="line"><span class="cl">│       └── variables.tf
</span></span><span class="line"><span class="cl">└── webserver
</span></span><span class="line"><span class="cl">    ├── main.tf
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate
</span></span><span class="line"><span class="cl">    ├── terraform.tfstate.backup
</span></span><span class="line"><span class="cl">    └── variables.tf</span></span></code></pre></div></div>
<p><strong>C</strong>omecemos editando nosso arquivo <em>variables.tf</em> do módulo <em>vm_setup</em>, que deverá ficar assim:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;region&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Região no AWS onde nossos recursos estarão.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;us-east-1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;ami&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Id da imagem EC2 que desejamos utilizar para nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instance_type&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tipo de instância a ser utilizado&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instancia_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas à nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;user_data&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Script a ser executado durante a criação da instância.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Origin port to receive connections.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Destination port to pass connections to.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Egress Origin port to receive connections from.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Destination port to pass connections to.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;sg_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas no security group&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs para a VPC&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a vpc&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;subnet_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a subnet&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;gw_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas ao gateway de internet&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_ips&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs a serem aplicados na route table&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas na route table&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>V</strong>ocê deve ter notado que retiramos praticamente todos os valores <em>default</em> das variáveis. Apenas mantivemos os valores para as variáveis <em>region</em>, <em>ami</em> e <em>instance_type</em>, pois queremos reaproveitar estes valores, visto que este é o padrão adotado por nossa empresa. Isto significa que não importa quantos projetos importem este módulo, estes valores sempre serão aproveitados. Já os demais, nós definiremos quando importarmos o módulo, visto que queremos um ip externo novo para cada instância, regras de firewall diferentes para cada instância, etc. Mas, este é apenas o nosso cenário, um módulo pode vir com valores pré-definidos para todas as variáveis ou mesmo com valores para nenhuma delas. Cada cenário trás suas particularidades.</p>
<p><strong>É</strong> importante lembrar também que você não é obrigado a ter uma vpc diferente para cada instância, bem como uma subnet e um gateway para cada instância. Estes recursos podem ser utilizados para diversas instâncias, porém no nosso exemplo teremos recursos dedicados.</p>
<p><strong>V</strong>amos agora incluir o seguinte conteúdo no arquivo <em>main.tf</em> de nosso módulo <em>vm_setup</em>:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">provider</span> <span class="s2">&#34;aws&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">region</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.region}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_vpc&#34;</span> <span class="s2">&#34;vpc&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cidr_block</span>           <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.vpc_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">enable_dns_hostnames</span> <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">  <span class="n">enable_dns_support</span>   <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.vpc_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_subnet&#34;</span> <span class="s2">&#34;subnet&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cidr_block</span>        <span class="o">=</span> <span class="s2">&#34;${cidrsubnet(aws_vpc.vpc.cidr_block, 3, 1)}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc_id</span>            <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_vpc.vpc.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">availability_zone</span> <span class="o">=</span> <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.subnet_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_security_group&#34;</span> <span class="s2">&#34;security_group&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;firewall_$</span><span class="si">{var.project_name}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_vpc.vpc.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">ingress</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">protocol</span>    <span class="o">=</span> <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cidr_blocks</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">egress</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">protocol</span>    <span class="o">=</span> <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cidr_blocks</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.sg_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_instance&#34;</span> <span class="s2">&#34;server&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">ami</span>           <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.ami}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.instance_type}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">user_data</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.user_data}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">security_groups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;$</span><span class="si">{aws_security_group.security_group.id}</span><span class="s2">&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">subnet_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_subnet.subnet.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.instance_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_eip&#34;</span> <span class="s2">&#34;ip&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">instance</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_instance.server.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc</span>      <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_internet_gateway&#34;</span> <span class="s2">&#34;gw&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_vpc.vpc.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.gw_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_route_table&#34;</span> <span class="s2">&#34;route_table&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_vpc.vpc.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">route</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cidr_block</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.route_ips}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">gateway_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_internet_gateway.gw.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.route_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resource</span> <span class="s2">&#34;aws_route_table_association&#34;</span> <span class="s2">&#34;subnet-association&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">subnet_id</span>      <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_subnet.subnet.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">route_table_id</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{aws_route_table.route_table.id}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>I</strong>sto é tudo o que precisamos fazer em nosso módulo <em>vm_setup</em>. Este módulo está pronto para ser reutilizado quantas vezes forem necessárias.</p>
<p><strong>A</strong>gora que temos toda a nossa base principal de código no módulo, vamos alterar nosso projeto <em>webserver</em>. Vamos editar o arquivo <em>main.tf</em> do projeto <em>webserver</em> para que ele não possua nenhum resource ou lógica de criação. Precisaremos apenas importar o nosso módulo e informar as variáveis que precisam ser passadas por terem sido deixadas sem valores definidos no módulo:</p>
<div class="code-block open" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">module</span> <span class="s2">&#34;vm_setup&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">source</span> <span class="o">=</span> <span class="s2">&#34;../modules/vm_setup&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">project_name</span>  <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.project_name}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">instance_tags</span> <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.instance_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">user_data</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.user_data}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i_from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i_to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i_ip_range</span>    <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.i_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">e_from_port</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_from_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">e_to_port</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_to_port}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">e_ip_range</span>    <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.e_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc_ip_range</span>  <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.vpc_ip_range}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">gw_tags</span>       <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.gw_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">route_ips</span>     <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.route_ips}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">route_tags</span>    <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.route_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">sg_tags</span>       <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.sg_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">vpc_tags</span>      <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.vpc_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">subnet_tags</span>   <span class="o">=</span> <span class="s2">&#34;$</span><span class="si">{var.subnet_tags}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>B</strong>om, está bem menor do que o antigo <em>main.tf</em> do <em>webserver</em>, certo?! Repare que ao invés de termos resources, agora temos apenas a chamada do módulo <em>(module)</em> e o parâmetro <em>source</em> que indica onde se encontra o nosso módulo.</p>
<p><strong>A</strong>gora que temos o <em>main.tf</em> pronto, vamos alterar e deixar da seguinte forma nosso arquivo <em>variables.tf</em> do projeto <em>webserver</em>:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;project_name&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Nome do projeto&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instance_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas à nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span>     <span class="o">=</span> <span class="s2">&#34;webserver-1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Ambiente&#34;</span> <span class="o">=</span> <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Projeto&#34;</span>  <span class="o">=</span> <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;user_data&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Script a ser executado durante a criação da instância.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="n">EOF</span>
</span></span><span class="line"><span class="cl">              <span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">apache2</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">apache2</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">apache2</span>
</span></span><span class="line"><span class="cl">              <span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="s1">&#39;Apache&#39;</span>
</span></span><span class="line"><span class="cl">              <span class="n">EOF</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Origin port to receive connections.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;80&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Destination port to pass connections to.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;80&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Egress Origin port to receive connections from.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Destination port to pass connections to.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs para a VPC&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;11.0.0.0/16&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;gw_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas ao gateway de internet&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-webserver-gw&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_ips&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs a serem aplicados na route table&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas na route table&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-webserver-route-table&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;sg_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas no security group&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-webserver-sg&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a vpc&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-webserver-vpc&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;subnet_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a subnet&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-webserver-subnet&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="p">}</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>J</strong>á podemos validar nosso código do webserver para termos certeza de que nosso módulo funciona. Execute <em>terraform init</em>, <em>terraform plan</em> e em seguida <em>terraform apply</em> dentro do diretório <em>webserver</em>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform init .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Initializing modules...
</span></span><span class="line"><span class="cl">- module.vm_setup
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Initializing provider plugins...
</span></span><span class="line"><span class="cl">- Checking <span class="k">for</span> available provider plugins on https://releases.hashicorp.com...
</span></span><span class="line"><span class="cl">- Downloading plugin <span class="k">for</span> provider <span class="s2">&#34;aws&#34;</span> <span class="o">(</span>2.12.0<span class="o">)</span>...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The following providers <span class="k">do</span> not have any version constraints in configuration,
</span></span><span class="line"><span class="cl">so the latest version was installed.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To prevent automatic upgrades to new major versions that may contain breaking
</span></span><span class="line"><span class="cl">changes, it is recommended to add <span class="nv">version</span> <span class="o">=</span> <span class="s2">&#34;...&#34;</span> constraints to the
</span></span><span class="line"><span class="cl">corresponding provider blocks in configuration, with the constraint strings
</span></span><span class="line"><span class="cl">suggested below.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* provider.aws: <span class="nv">version</span> <span class="o">=</span> <span class="s2">&#34;~&gt; 2.12&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Terraform has been successfully initialized!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You may now begin working with Terraform. Try running <span class="s2">&#34;terraform plan&#34;</span> to see
</span></span><span class="line"><span class="cl">any changes that are required <span class="k">for</span> your infrastructure. All Terraform commands
</span></span><span class="line"><span class="cl">should now work.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">If you ever <span class="nb">set</span> or change modules or backend configuration <span class="k">for</span> Terraform,
</span></span><span class="line"><span class="cl">rerun this <span class="nb">command</span> to reinitialize your working directory. If you forget, other
</span></span><span class="line"><span class="cl">commands will detect it and remind you to <span class="k">do</span> so <span class="k">if</span> necessary.</span></span></code></pre></div></div>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform plan
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Refreshing Terraform state in-memory prior to plan...
</span></span><span class="line"><span class="cl">The refreshed state will be used to calculate this plan, but will not be
</span></span><span class="line"><span class="cl">persisted to <span class="nb">local</span> or remote state storage.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">An execution plan has been generated and is shown below.
</span></span><span class="line"><span class="cl">Resource actions are indicated with the following symbols:
</span></span><span class="line"><span class="cl">  + create
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Terraform will perform the following actions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_eip.ip
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      allocation_id:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      association_id:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      domain:                                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance:                                   <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_instance</span><span class="p">.server.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      network_interface:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ipv4_pool:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc:                                        <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_instance.server
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ami:                                        <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      associate_public_ip_address:                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      availability_zone:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_core_count:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_threads_per_core:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ebs_block_device.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ephemeral_block_device.#:                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      get_password_data:                          <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      host_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_state:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_type:                              <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_address_count:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_addresses.#:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      key_name:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface.#:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface_id:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      password_data:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      placement_group:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      primary_network_interface_id:               &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      root_block_device.#:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      security_groups.#:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      source_dest_check:                          <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Ambiente:                              <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;webserver-1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Projeto:                               <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">      tenancy:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      user_data:                                  <span class="s2">&#34;667f17a65f03728b9c8f8c29166f86915a180f0b&#34;</span>
</span></span><span class="line"><span class="cl">      volume_tags.%:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc_security_group_ids.#:                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_internet_gateway.gw
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-webserver-gw&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_route_table.route_table
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      propagating_vgws.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route.#:                                    <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.cidr_block:                <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.gateway_id:                <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_internet_gateway</span><span class="p">.gw.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.instance_id:               <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.nat_gateway_id:            <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.network_interface_id:      <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.transit_gateway_id:        <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-webserver-route-table&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_route_table_association.subnet-association
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route_table_id:                             <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_route_table</span><span class="p">.route_table.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_security_group.security_group
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      description:                                <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.#:                                   <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.#:             <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.0:             <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.description:               <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.482069346.from_port:                 <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.ipv6_cidr_blocks.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.prefix_list_ids.#:         <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.protocol:                  <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.security_groups.#:         <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.self:                      <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.to_port:                   <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.#:                                  <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.cidr_blocks.#:           <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.cidr_blocks.0:           <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.description:             <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.from_port:               <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.ipv6_cidr_blocks.#:      <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.prefix_list_ids.#:       <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.protocol:                <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.security_groups.#:       <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.self:                    <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.2214680975.to_port:                 <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">      name:                                       <span class="s2">&#34;firewall_Webserver&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      revoke_rules_on_delete:                     <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-webserver-sg&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_subnet.subnet
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_ipv6_address_on_creation:            <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone:                          <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone_id:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cidr_block:                                 <span class="s2">&#34;11.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block_association_id:             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      map_public_ip_on_launch:                    <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-webserver-subnet&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_vpc.vpc
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_generated_ipv6_cidr_block:           <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      cidr_block:                                 <span class="s2">&#34;11.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">      default_network_acl_id:                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_route_table_id:                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_security_group_id:                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      dhcp_options_id:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink_dns_support:             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_dns_hostnames:                       <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      enable_dns_support:                         <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      instance_tenancy:                           <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_association_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      main_route_table_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-webserver-vpc&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Plan: <span class="m">8</span> to add, <span class="m">0</span> to change, <span class="m">0</span> to destroy.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: You didn<span class="s1">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span></span></span><span class="line"><span class="cl"><span class="s1">can&#39;</span>t guarantee that exactly these actions will be performed <span class="k">if</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;terraform apply&#34;</span> is subsequently run.</span></span></code></pre></div></div>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">(</span>...<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_vpc.vpc: Creating...
</span></span><span class="line"><span class="cl">  arn:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_generated_ipv6_cidr_block: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;11.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">  default_network_acl_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_route_table_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_security_group_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  dhcp_options_id:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink_dns_support:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_hostnames:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_support:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  instance_tenancy:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_association_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  main_route_table_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-webserver-vpc&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_vpc.vpc: Creation <span class="nb">complete</span> after 4s <span class="o">(</span>ID: vpc-0b0b7f39832971416<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_internet_gateway.gw: Creating...
</span></span><span class="line"><span class="cl">  owner_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:    <span class="s2">&#34;0&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-webserver-gw&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0b0b7f39832971416&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_subnet.subnet: Creating...
</span></span><span class="line"><span class="cl">  arn:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_ipv6_address_on_creation: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;11.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block_association_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  map_public_ip_on_launch:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-webserver-subnet&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0b0b7f39832971416&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_security_group.security_group: Creating...
</span></span><span class="line"><span class="cl">  arn:                                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  description:                           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.#:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.#:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.0:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.description:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.482069346.from_port:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.ipv6_cidr_blocks.#:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.prefix_list_ids.#:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.protocol:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.security_groups.#:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.self:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.to_port:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.#:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.cidr_blocks.#:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.cidr_blocks.0:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.description:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.from_port:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.ipv6_cidr_blocks.#: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.prefix_list_ids.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.protocol:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.security_groups.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.self:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.2214680975.to_port:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl">  name:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;firewall_Webserver&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  revoke_rules_on_delete:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-webserver-sg&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0b0b7f39832971416&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_subnet.subnet: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: subnet-09a5fd6f1e134a585<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_internet_gateway.gw: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: igw-001720b264c39106f<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table.route_table: Creating...
</span></span><span class="line"><span class="cl">  owner_id:                                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  propagating_vgws.#:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  route.#:                                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.cidr_block:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.gateway_id:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;igw-001720b264c39106f&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.instance_id:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.nat_gateway_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.network_interface_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.transit_gateway_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.1246881252.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-webserver-route-table&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-0b0b7f39832971416&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table.route_table: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: rtb-0fa5e3d6be5f766fe<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table_association.subnet-association: Creating...
</span></span><span class="line"><span class="cl">  route_table_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;rtb-0fa5e3d6be5f766fe&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-09a5fd6f1e134a585&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_security_group.security_group: Creation <span class="nb">complete</span> after 3s <span class="o">(</span>ID: sg-0ca0d6c884a414b58<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Creating...
</span></span><span class="line"><span class="cl">  ami:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">  arn:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  associate_public_ip_address:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_core_count:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_threads_per_core:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ebs_block_device.#:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ephemeral_block_device.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  get_password_data:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  host_id:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_state:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_type:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_address_count:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_addresses.#:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  key_name:                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface_id:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  password_data:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  placement_group:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  primary_network_interface_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  root_block_device.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.#:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.451482694:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;sg-0ca0d6c884a414b58&#34;</span>
</span></span><span class="line"><span class="cl">  source_dest_check:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-09a5fd6f1e134a585&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Ambiente:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;webserver-1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Projeto:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Webserver&#34;</span>
</span></span><span class="line"><span class="cl">  tenancy:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  user_data:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;667f17a65f03728b9c8f8c29166f86915a180f0b&#34;</span>
</span></span><span class="line"><span class="cl">  volume_tags.%:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_security_group_ids.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table_association.subnet-association: Creation <span class="nb">complete</span> after 0s <span class="o">(</span>ID: rtbassoc-00a9a948e69786f49<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Still creating... <span class="o">(</span>10s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Still creating... <span class="o">(</span>20s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Creation <span class="nb">complete</span> after 24s <span class="o">(</span>ID: i-0488ccf1f11a615b4<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_eip.ip: Creating...
</span></span><span class="line"><span class="cl">  allocation_id:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  association_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  domain:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;i-0488ccf1f11a615b4&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ipv4_pool:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_eip.ip: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: eipalloc-02469b07ece998da1<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apply complete! Resources: <span class="m">8</span> added, <span class="m">0</span> changed, <span class="m">0</span> destroyed.</span></span></code></pre></div></div>
<p><strong>T</strong>udo parece ter funcionado. 8 <em>resources</em> criados. Sinta-se livre para ir à dashboard do AWS e verificar que a instância webserver-1 foi criada, bem como o security group, vpc, etc.</p>
<p><strong>C</strong>omo estamos executando um script para instalar o Apache, devemos dar alguns poucos minutos para que a máquina finalize toda essa configuração e em seguida já podemos testar com <em>curl</em> ou através do navegador utilizando o DNS público que foi gerado para esta instância.</p>
<p><strong>C</strong>omo nem sempre as coisas fluem como esperamos no trabalho, devido a constantes mudanças de escopo nos projetos ou mesmo de prioridades, logo quando finalizamos a criação do módulo e criamos nossa instância webserver nosso gerente informou que os planos mudaram e que o projeto <em>db</em> ia parar por enquanto. Surgiu um projeto com prioridade maior: o projeto de integração contínua <em>(continuous integration)</em> ou simplesmente CI.</p>
<p><strong>P</strong>ara que as equipes de desenvolvimento possam começar a trabalhar e a testar seu código, elas precisam de uma ferramenta de CI e a escolhida pela equipe foi o <em>jenkins</em>.</p>
<p><strong>C</strong>om esta mudança, nós agora precisamos criar o projeto <em>jenkins</em>.</p>
<p><strong>E</strong>mbora possa parecer um grande trabalho, nós já temos nosso módulo que criará tudo o que precisaremos para subir uma instância com todos os requisitos de rede. Tudo o que precisaremos fazer é alterar algumas poucas variáveis, certo!?</p>
<p><strong>C</strong>omo prova disso, vamos apenas copiar os arquivos <em>main.tf</em> e <em>variables.tf</em> do nosso projeto <em>webserver</em> e colar ambos em um novo diretório <em>jenkins</em>. Navegue até o diretório principal terraform e execute os comandos a seguir ou copie e cole através de sua interface gráfica:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ mkdir jenkins <span class="o">&amp;&amp;</span> cp webserver/*.tf jenkins/</span></span></code></pre></div></div>
<p><strong>C</strong>omo não possuímos nenhum valor declarado diretamente no arquivo <em>main.tf</em>, não precisamos alterar absolutamente nada neste arquivo para o projeto <em>jenkins</em>. Vamos então fazer algumas poucas alterações no arquivo <em>variables.tf</em> do projeto <em>jenkins</em>:</p>
<div class="code-block" style="counter-reset: code-block -1">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;project_name&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Nome do projeto&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;Jenkins&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;instance_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas à nossa instância.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span>     <span class="o">=</span> <span class="s2">&#34;jenkins-1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Ambiente&#34;</span> <span class="o">=</span> <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Projeto&#34;</span>  <span class="o">=</span> <span class="s2">&#34;Jenkins&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;user_data&#34;</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Script a ser executado durante a criação da instância.&#34;</span>
</span></span><span class="line hl"><span class="cl">
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="n">EOF</span>
</span></span><span class="line hl"><span class="cl">              <span class="c1">#!/bin/bash</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">wget</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pkg</span><span class="o">.</span><span class="n">jenkins</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">jenkins</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list&#39;</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">default</span><span class="o">-</span><span class="n">jre</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">jenkins</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">jenkins</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">jenkins</span>
</span></span><span class="line hl"><span class="cl">              <span class="n">EOF</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Origin port to receive connections.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Destination port to pass connections to.&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;i_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ingress Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_from_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Egress Origin port to receive connections from.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_to_port&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Destination port to pass connections to.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;e_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;list&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Ip range that will be able to connect to this server.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;0.0.0.0/0&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_ip_range&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs para a VPC&#34;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;12.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;gw_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas ao gateway de internet&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-jenkins-gw&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_ips&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Range de IPs a serem aplicados na route table&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">default</span>     <span class="o">=</span> <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;route_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas na route table&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-jenkins-route-table&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;sg_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas no security group&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-jenkins-sg&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;vpc_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a vpc&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-jenkins-vpc&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">variable</span> <span class="s2">&#34;subnet_tags&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>        <span class="o">=</span> <span class="s2">&#34;map&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">description</span> <span class="o">=</span> <span class="s2">&#34;Tags a serem aplicadas a subnet&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="s2">&#34;Name&#34;</span> <span class="o">=</span> <span class="s2">&#34;dev-jenkins-subnet&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>

<p><strong>B</strong>asicamente alteramos algumas variáveis e o script de instalação, visto que aqui instalaremos o Jenkins e não o Apache.</p>
<p><strong>P</strong>ara termos certeza de que nosso código funcionará, navegue até o diretório <em>jenkins</em> e execute <em>terraform init</em>, <em>terraform plan</em> e <em>terraform apply</em>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform init
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Initializing modules...
</span></span><span class="line"><span class="cl">- module.vm_setup
</span></span><span class="line"><span class="cl">  Getting <span class="nb">source</span> <span class="s2">&#34;../modules/vm_setup&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Initializing provider plugins...
</span></span><span class="line"><span class="cl">- Checking <span class="k">for</span> available provider plugins on https://releases.hashicorp.com...
</span></span><span class="line"><span class="cl">- Downloading plugin <span class="k">for</span> provider <span class="s2">&#34;aws&#34;</span> <span class="o">(</span>2.12.0<span class="o">)</span>...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The following providers <span class="k">do</span> not have any version constraints in configuration,
</span></span><span class="line"><span class="cl">so the latest version was installed.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To prevent automatic upgrades to new major versions that may contain breaking
</span></span><span class="line"><span class="cl">changes, it is recommended to add <span class="nv">version</span> <span class="o">=</span> <span class="s2">&#34;...&#34;</span> constraints to the
</span></span><span class="line"><span class="cl">corresponding provider blocks in configuration, with the constraint strings
</span></span><span class="line"><span class="cl">suggested below.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* provider.aws: <span class="nv">version</span> <span class="o">=</span> <span class="s2">&#34;~&gt; 2.12&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Terraform has been successfully initialized!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You may now begin working with Terraform. Try running <span class="s2">&#34;terraform plan&#34;</span> to see
</span></span><span class="line"><span class="cl">any changes that are required <span class="k">for</span> your infrastructure. All Terraform commands
</span></span><span class="line"><span class="cl">should now work.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">If you ever <span class="nb">set</span> or change modules or backend configuration <span class="k">for</span> Terraform,
</span></span><span class="line"><span class="cl">rerun this <span class="nb">command</span> to reinitialize your working directory. If you forget, other
</span></span><span class="line"><span class="cl">commands will detect it and remind you to <span class="k">do</span> so <span class="k">if</span> necessary.</span></span></code></pre></div></div>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform plan
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Refreshing Terraform state in-memory prior to plan...
</span></span><span class="line"><span class="cl">The refreshed state will be used to calculate this plan, but will not be
</span></span><span class="line"><span class="cl">persisted to <span class="nb">local</span> or remote state storage.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">An execution plan has been generated and is shown below.
</span></span><span class="line"><span class="cl">Resource actions are indicated with the following symbols:
</span></span><span class="line"><span class="cl">  + create
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Terraform will perform the following actions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_eip.ip
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      allocation_id:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      association_id:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      domain:                                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance:                                   <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_instance</span><span class="p">.server.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      network_interface:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ipv4_pool:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc:                                        <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_instance.server
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ami:                                        <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      associate_public_ip_address:                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      availability_zone:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_core_count:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cpu_threads_per_core:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ebs_block_device.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ephemeral_block_device.#:                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      get_password_data:                          <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      host_id:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_state:                             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      instance_type:                              <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_address_count:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_addresses.#:                           &lt;computed&gt;
</span></span><span class="line"><span class="cl">      key_name:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface.#:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      network_interface_id:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      password_data:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      placement_group:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      primary_network_interface_id:               &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_dns:                                &lt;computed&gt;
</span></span><span class="line"><span class="cl">      private_ip:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_dns:                                 &lt;computed&gt;
</span></span><span class="line"><span class="cl">      public_ip:                                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      root_block_device.#:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      security_groups.#:                          &lt;computed&gt;
</span></span><span class="line"><span class="cl">      source_dest_check:                          <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Ambiente:                              <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;jenkins-1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Projeto:                               <span class="s2">&#34;Jenkins&#34;</span>
</span></span><span class="line"><span class="cl">      tenancy:                                    &lt;computed&gt;
</span></span><span class="line"><span class="cl">      user_data:                                  <span class="s2">&#34;d9fc733fb7880cd2d7da5ac8dc490d7dc583ed51&#34;</span>
</span></span><span class="line"><span class="cl">      volume_tags.%:                              &lt;computed&gt;
</span></span><span class="line"><span class="cl">      vpc_security_group_ids.#:                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_internet_gateway.gw
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-jenkins-gw&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_route_table.route_table
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      propagating_vgws.#:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route.#:                                    <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.cidr_block:                <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.gateway_id:                <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_internet_gateway</span><span class="p">.gw.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.instance_id:               <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.nat_gateway_id:            <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.network_interface_id:      <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.transit_gateway_id:        <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      route.~966145399.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-jenkins-route-table&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_route_table_association.subnet-association
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      route_table_id:                             <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_route_table</span><span class="p">.route_table.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      subnet_id:                                  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_subnet</span><span class="p">.subnet.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_security_group.security_group
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      description:                                <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.#:                                   <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.#:             <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.cidr_blocks.0:             <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.description:               <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      egress.482069346.from_port:                 <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.ipv6_cidr_blocks.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.prefix_list_ids.#:         <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.protocol:                  <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.security_groups.#:         <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.self:                      <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      egress.482069346.to_port:                   <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.#:                                  <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.cidr_blocks.#:            <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.cidr_blocks.0:            <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.description:              <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.from_port:                <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.ipv6_cidr_blocks.#:       <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.prefix_list_ids.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.protocol:                 <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.security_groups.#:        <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.self:                     <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      ingress.516175195.to_port:                  <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl">      name:                                       <span class="s2">&#34;firewall_Jenkins&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      revoke_rules_on_delete:                     <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-jenkins-sg&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_subnet.subnet
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_ipv6_address_on_creation:            <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone:                          <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">      availability_zone_id:                       &lt;computed&gt;
</span></span><span class="line"><span class="cl">      cidr_block:                                 <span class="s2">&#34;12.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block_association_id:             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      map_public_ip_on_launch:                    <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-jenkins-subnet&#34;</span>
</span></span><span class="line"><span class="cl">      vpc_id:                                     <span class="s2">&#34;</span><span class="si">${</span><span class="nv">aws_vpc</span><span class="p">.vpc.id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  + module.vm_setup.aws_vpc.vpc
</span></span><span class="line"><span class="cl">      id:                                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      arn:                                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      assign_generated_ipv6_cidr_block:           <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">      cidr_block:                                 <span class="s2">&#34;12.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">      default_network_acl_id:                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_route_table_id:                     &lt;computed&gt;
</span></span><span class="line"><span class="cl">      default_security_group_id:                  &lt;computed&gt;
</span></span><span class="line"><span class="cl">      dhcp_options_id:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink:                         &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_classiclink_dns_support:             &lt;computed&gt;
</span></span><span class="line"><span class="cl">      enable_dns_hostnames:                       <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      enable_dns_support:                         <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">      instance_tenancy:                           <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">      ipv6_association_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      ipv6_cidr_block:                            &lt;computed&gt;
</span></span><span class="line"><span class="cl">      main_route_table_id:                        &lt;computed&gt;
</span></span><span class="line"><span class="cl">      owner_id:                                   &lt;computed&gt;
</span></span><span class="line"><span class="cl">      tags.%:                                     <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">      tags.Name:                                  <span class="s2">&#34;dev-jenkins-vpc&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Plan: <span class="m">8</span> to add, <span class="m">0</span> to change, <span class="m">0</span> to destroy.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: You didn<span class="s1">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span></span></span><span class="line"><span class="cl"><span class="s1">can&#39;</span>t guarantee that exactly these actions will be performed <span class="k">if</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;terraform apply&#34;</span> is subsequently run.</span></span></code></pre></div></div>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copiar para a área de transferência"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ terraform apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">(</span>...<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_vpc.vpc: Creating...
</span></span><span class="line"><span class="cl">  arn:                              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_generated_ipv6_cidr_block: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;12.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl">  default_network_acl_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_route_table_id:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  default_security_group_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  dhcp_options_id:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_classiclink_dns_support:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_hostnames:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  enable_dns_support:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  instance_tenancy:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;default&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_association_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  main_route_table_id:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-jenkins-vpc&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_vpc.vpc: Creation <span class="nb">complete</span> after 4s <span class="o">(</span>ID: vpc-00ee097ac9aafa4ae<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_internet_gateway.gw: Creating...
</span></span><span class="line"><span class="cl">  owner_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:    <span class="s2">&#34;0&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-jenkins-gw&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-00ee097ac9aafa4ae&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_subnet.subnet: Creating...
</span></span><span class="line"><span class="cl">  arn:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  assign_ipv6_address_on_creation: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;us-east-1a&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cidr_block:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;12.0.32.0/19&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_cidr_block_association_id:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  map_public_ip_on_launch:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-jenkins-subnet&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-00ee097ac9aafa4ae&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_security_group.security_group: Creating...
</span></span><span class="line"><span class="cl">  arn:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  description:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Managed by Terraform&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.#:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.#:       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.cidr_blocks.0:       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.description:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  egress.482069346.from_port:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.ipv6_cidr_blocks.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.prefix_list_ids.#:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.protocol:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;-1&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.security_groups.#:   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.self:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  egress.482069346.to_port:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.#:                            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.cidr_blocks.#:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.cidr_blocks.0:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.description:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">images: <span class="o">[]</span>
</span></span><span class="line"><span class="cl">resources:
</span></span><span class="line"><span class="cl">- name: <span class="s2">&#34;featured-image&#34;</span>
</span></span><span class="line"><span class="cl">  src: <span class="s2">&#34;featured-image.jpg&#34;</span>
</span></span><span class="line"><span class="cl">lightgallery: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.from_port:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.ipv6_cidr_blocks.#: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.prefix_list_ids.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.protocol:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.security_groups.#:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.self:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  ingress.516175195.to_port:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;8080&#34;</span>
</span></span><span class="line"><span class="cl">  name:                                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;firewall_Jenkins&#34;</span>
</span></span><span class="line"><span class="cl">  owner_id:                             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  revoke_rules_on_delete:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-jenkins-sg&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-00ee097ac9aafa4ae&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_subnet.subnet: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: subnet-056036d490766f53f<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_internet_gateway.gw: Creation <span class="nb">complete</span> after 2s <span class="o">(</span>ID: igw-07d91193ed6199e69<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table.route_table: Creating...
</span></span><span class="line"><span class="cl">  owner_id:                                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  propagating_vgws.#:                         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  route.#:                                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.cidr_block:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;0.0.0.0/0&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.egress_only_gateway_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.gateway_id:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;igw-07d91193ed6199e69&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.instance_id:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.ipv6_cidr_block:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.nat_gateway_id:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.network_interface_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.transit_gateway_id:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  route.2483516231.vpc_peering_connection_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;dev-jenkins-route-table&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_id:                                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;vpc-00ee097ac9aafa4ae&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table.route_table: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: rtb-0ce8ab0131038ace4<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table_association.subnet-association: Creating...
</span></span><span class="line"><span class="cl">  route_table_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;rtb-0ce8ab0131038ace4&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-056036d490766f53f&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_route_table_association.subnet-association: Creation <span class="nb">complete</span> after 0s <span class="o">(</span>ID: rtbassoc-079c784b79f6afbde<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_security_group.security_group: Creation <span class="nb">complete</span> after 4s <span class="o">(</span>ID: sg-0cf1f754345d2077f<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Creating...
</span></span><span class="line"><span class="cl">  ami:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;ami-0a313d6098716f372&#34;</span>
</span></span><span class="line"><span class="cl">  arn:                          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  associate_public_ip_address:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  availability_zone:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_core_count:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  cpu_threads_per_core:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ebs_block_device.#:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ephemeral_block_device.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  get_password_data:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">  host_id:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_state:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance_type:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;t2.micro&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_address_count:           <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  ipv6_addresses.#:             <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  key_name:                     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface_id:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  password_data:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  placement_group:              <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  primary_network_interface_id: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:                  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:                   <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  root_block_device.#:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.#:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  security_groups.674803908:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;sg-0cf1f754345d2077f&#34;</span>
</span></span><span class="line"><span class="cl">  source_dest_check:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  subnet_id:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;subnet-056036d490766f53f&#34;</span>
</span></span><span class="line"><span class="cl">  tags.%:                       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Ambiente:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Desenvolvimento&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Name:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;jenkins-1&#34;</span>
</span></span><span class="line"><span class="cl">  tags.Projeto:                 <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;Jenkins&#34;</span>
</span></span><span class="line"><span class="cl">  tenancy:                      <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  user_data:                    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;d9fc733fb7880cd2d7da5ac8dc490d7dc583ed51&#34;</span>
</span></span><span class="line"><span class="cl">  volume_tags.%:                <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc_security_group_ids.#:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Still creating... <span class="o">(</span>10s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Still creating... <span class="o">(</span>20s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Still creating... <span class="o">(</span>30s elapsed<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_instance.server: Creation <span class="nb">complete</span> after 33s <span class="o">(</span>ID: i-01b616db95cdfce42<span class="o">)</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_eip.ip: Creating...
</span></span><span class="line"><span class="cl">  allocation_id:     <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  association_id:    <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  domain:            <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  instance:          <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;i-01b616db95cdfce42&#34;</span>
</span></span><span class="line"><span class="cl">  network_interface: <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_dns:       <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  private_ip:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_dns:        <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ip:         <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  public_ipv4_pool:  <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;&lt;computed&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  vpc:               <span class="s2">&#34;&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">module.vm_setup.aws_eip.ip: Creation <span class="nb">complete</span> after 1s <span class="o">(</span>ID: eipalloc-0da512c233d8d51b8<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apply complete! Resources: <span class="m">8</span> added, <span class="m">0</span> changed, <span class="m">0</span> destroyed.</span></span></code></pre></div></div>
<p><strong>A</strong>ssim como com o <em>webserver</em>, precisamos aguardar alguns minutos após a finalização do <em>terraform apply</em>, visto que ao finalizar tudo, a instância começará a executar o nosso bash script que, neste caso, terá que instalar o java e o jenkins na instância.</p>
<p><strong>A</strong>pós alguns minutos, copie o endereço DNS que foi atribuído a ela a partir da interface do AWS e cole-a em seu browser adicionando a porta <em>8080</em>, que é a padrão do Jenkins:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/terraform_aws15.jpg"
        data-srcset="/img/terraform_aws15.jpg, /img/terraform_aws15.jpg 1.5x, /img/terraform_aws15.jpg 2x"
        data-sizes="auto"
        alt="/img/terraform_aws15.jpg"
        title="AWS IAM" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/terraform_aws16.jpg"
        data-srcset="/img/terraform_aws16.jpg, /img/terraform_aws16.jpg 1.5x, /img/terraform_aws16.jpg 2x"
        data-sizes="auto"
        alt="/img/terraform_aws16.jpg"
        title="AWS IAM" /></p>
<p><strong>P</strong>ara quem nunca instalou o Jenkins, esta é de fato a tela do Jenkins inicial. Por questões de segurança, logo quando instalado, o Jenkins vem bloqueado e requer um desbloqueio através de uma senha que o mesmo gera no ato da instalação. Mas o nosso assunto aqui não é Jenkins, mas sim a utilização de módulos com o Terraform e, neste caso, a nossa missão está de fato cumprida. Bom, ao menos até que a diretoria da empresa nos solicite outra mudança ou decida que o projeto <em>bd</em> vai ser implementado de fato.</p>
<p><strong>S</strong>inta-se livre para brincar com este código e criar novas instâncias de teste reaproveitando todo o código que criamos aqui. ;]</p>
<p><strong>Não esqueça</strong> de executar <em>terraform destroy</em> em ambos os diretórios, <em>webserver</em> e <em>jenkins</em> para evitar de deixar resources rodando sem necessidade no AWS.</p>
<p><strong>E</strong>ste código completo encontra-se disponível aqui: <a href="https://github.com/kalib/examples/tree/master/blog_codes/terraform" target="_blank" rel="noopener noreffer ">https://github.com/kalib/examples/tree/master/blog_codes/terraform</a></p>
<p><strong>H</strong>appy Hacking!</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Atualizado em 2019-05-20</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartilhe em X" data-sharer="x" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2" data-via="Marcelo_Kalib" data-hashtags="Devops,Terraform,Cloud,AWS"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em Threads" data-sharer="threads" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em Facebook" data-sharer="facebook" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-hashtag="Devops"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em Hacker News" data-sharer="hackernews" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em Line" data-sharer="line" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@15.14.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em 微博" data-sharer="weibo" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartilhe em Diaspora" data-sharer="diaspora" data-url="//blog.marcelocavalcante.net:1313/posts/terraform-modules-porque-e-como-copy/" data-title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2" data-description="Todos sabem que o Terraform é uma solucão fantástica para criar infraestrutura através de código, porém nem todos utilizam as diversas possibilidades do mesmo, como por exemplos módulos. Com módulos podemos fazer a reutilização de código para nossa infraestrutura."><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=%2f%2fblog.marcelocavalcante.net%3a1313%2fposts%2fterraform-modules-porque-e-como-copy%2f&amp;text=Terraform%20Modules%3a%20Porqu%c3%aa%20E%20Como%20Trabalhar%20Com%20M%c3%b3dulos%20No%20Terraform%20-%20PARTE%202" target="_blank" title="Compartilhe em Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/devops/">Devops</a>,&nbsp;<a href="/tags/terraform/">Terraform</a>,&nbsp;<a href="/tags/cloud/">Cloud</a>,&nbsp;<a href="/tags/aws/">AWS</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Voltar</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/terraform-modules-porque-e-como/" class="prev" rel="prev" title="Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Terraform Modules: Porquê E Como Trabalhar Com Módulos No Terraform - PARTE 2</a>
            <a href="/posts/criando-uma-pipeline-para-terraform/" class="next" rel="next" title="Criando Uma Pipeline Para Terraform Com o Gitlab">Criando Uma Pipeline Para Terraform Com o Gitlab<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Possibilitado por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2008 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.marcelocavalcante.net" target="_blank">Marcelo Cavalcante</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Voltar ao topo">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="Ver comentários">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script src="https://marcelokalib.disqus.com/embed.js" defer></script><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.pt.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js"></script><script>window.config={"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrLanguageCode":"pt","maxResultLength":10,"noResultsFound":"Nenhum resultado encontrado","snippetLength":30}};</script><script src="/js/theme.min.js"></script></body>
</html>
